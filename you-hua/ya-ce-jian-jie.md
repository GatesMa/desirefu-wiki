# 压测简介

### 1 简介

性能测试包括负载测试、压力测试和容量测试三种主要测试类型和其他测试类型。

**性能测试**就是用来测试软件在系统中的运行性能的。可以对单独模块测试，但只有整个系统集成后测试的性能才是真正的性能;

**负载测试**是为了检验系统在给定负载下是否能达到预期性能指标；

**容量测试**针对数据库而言，是在数据库中有较大数量的数据记录情况下对系统进行的测试；

**压力测试**是通过不断向被测系统施加“压力”，测试系统在压力情况下的性能表现，考察当前软硬件环境下系统所能承受的最大负荷并帮助找出系统瓶颈所在，也就是我们可以模拟巨大的工作负荷以查看应用程序在峰值使用情况下如何执行操作。

Web服务处于分布式计算的核心位置，它们之间的交互通常很难测试。分布式开发、大型的开发者团队以及对代码日益组件化的期望都有可能使Web服务的开发变得越来越容易隐藏错误。这些类型的错误极难检测出来。压力测试是检测这类代码错误的一种有效方法，但是只有在压力系统设计得比较有效的情况下才能发挥作用。压力测试考察当前软硬件环境下系统所能承受的最大负荷并帮助找出系统瓶颈所在。

### 2 压测相关的一些指标：

QPS（Queries Per Second）：每秒能够响应的查询次数，也即是最大吞吐能力（吞吐量）。 TPS（Transactions Per Second）：每秒处理的事务数目。一个事务是指一个客户端向服务器发送请求然后服务器做出反应的过程。TPS 的过程包括：客户端请求服务端、服务端内部处理、服务端返回客户端。 例如，访问一个页面会请求服务器 3 次，那么访问这一个页面就会产生一个TPS，三个QPS。 

  一个系统的吞度量（承压能力）与request对CPU的消耗、外部接口、IO等等紧密关联。单个reqeust 对CPU消耗越高，外部系统接口、IO影响速度越慢，系统吞吐能力越低，反之越高。系统吞吐量几个重要参数：QPS（TPS）、并发数、响应时间。QPS（TPS）：每秒钟request/事务 数量。并发数： 系统同时处理的request/事务数。响应时间：  一般取平均响应时间。

QPS（TPS）= 并发数/平均响应时间

        一个系统吞吐量通常由QPS（TPS）、并发数两个因素决定，每套系统这两个值都有一个相对极限值，在应用场景访问压力下，只要某一项达到系统最高值，系统的吞吐量就上不去了，如果压力继续增大，系统的吞吐量反而会下降，原因是系统超负荷工作，上下文切换、内存等等其它消耗导致系统性能下降。

### 3 Thread Group（线程组）

Thread Group（线程组），主要包含以下3个参数：

**1）线程数：Number of Threads（users），虚拟用户数**  
 1个虚拟用户占用1个进程or线程，需要多少个虚拟用户就设置对应数量的线程数。

**2）准备时长：Ramp-Up Period\(in seconds\)，表示设置的虚拟用户数全部启动所需的时间**  
 如：线程数=20个，准备时长=10s ==&gt; 20/10=2 \(个/s\)，即每秒启动2个线程

**3）循环次数：Loop Count，每个线程发送请求的次数**  
 如：线程数=20个，循环次数=5次 ==&gt; 总请求数目=20×5=100 \(个\)  
 PS：若勾选"forever"，则线程会一直发送请求，直至选择停止运行脚本

### **4 聚合报告分析**

![](../.gitbook/assets/image%20%2866%29.png)

| Term | Definition |
| :--- | :--- |
| Samples | 本次测试一共发出的请求数 \(如：模拟10个用户，每个用户循环6次，则总请求数=10×6=60\) |
| Average | 平均响应时间\(ms\)。默认情况是每个Request的平均响应时间； 若使用Transaction Controller，则表示每个Transaction显示的平均响应时间 |
| Median | 响应时间的中位数。表示50%用户的响应时间 |
| 90%Line | 90%用户的响应时间 |
| Min | 最小响应时间 |
| Max | 最大响应时间 |
| Error% | 出现错误的请求数占比\[\(错误请求数/请求总数\)×100%\] |
| Throughput | 吞吐量。默认表示每秒完成的请求数\(Request per second\)； 若使用Transaction Controller，则表示每秒处理的事务数\(Transaction per second\) |
| Received KB/sec | 每秒从服务端接收到的数据量 |
| Sent KB/sec | 每秒向服务端发送的数据量 |
| Label | Jmeter中元件的Name属性值 |

